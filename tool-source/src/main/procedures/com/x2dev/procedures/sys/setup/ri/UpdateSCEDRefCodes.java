/*
 * ====================================================================
 *
 * X2 Development Corporation
 *
 * Copyright (c) 2002-2006 X2 Development Corporation.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, is not permitted without express written agreement
 * from X2 Development Corporation.
 *
 * ====================================================================
 */

package com.x2dev.procedures.sys.setup.ri;

import com.follett.fsc.core.framework.persistence.X2Criteria;
import com.follett.fsc.core.k12.beans.ReferenceCode;
import com.follett.fsc.core.k12.beans.X2BaseBean;
import com.follett.fsc.core.k12.business.ModelBroker;
import com.follett.fsc.core.k12.business.X2Broker;
import com.follett.fsc.core.k12.business.dictionary.DataDictionary;
import com.follett.fsc.core.k12.business.dictionary.DataDictionaryField;
import com.follett.fsc.core.k12.tools.procedures.ProcedureJavaSource;
import com.x2dev.sis.model.beans.Course;
import com.x2dev.utils.StringUtils;
import com.x2dev.utils.X2BaseException;
import java.util.Set;
import org.apache.ojb.broker.query.QueryByCriteria;

/**
 * Procedure to import the EIS State ID for Tennessee.
 *
 * @author Follett Software
 */
public class UpdateSCEDRefCodes extends ProcedureJavaSource {

    /**
     * Fields used in export operations.
     */
    public enum CODES_TO_UPDATE {
        CODE_001("02135", "IB Mathematics, MiddleYearsProgram", "02135"), CODE_002("03000",
                "Life and Physical Sciences",
                "03000"), CODE_003("03163", "AP Physics C: ElectricityandMagnetism", "03163"), CODE_004("03213",
                        "IB Sciences, MiddleYearsProgram",
                        "03213"), CODE_005("04000", "Social Sciences and History", "04000"), CODE_006("04171",
                                "IB Humanities, Middle Years Program",
                                "04171"), CODE_007("05000", "Fine and Performing Arts", "05000"), CODE_008("05006",
                                        "Dance Survey",
                                        "05006"), CODE_009("05060", "Musical Theater", "05060"), CODE_010("05061",
                                                "Theatrical Productionand Management",
                                                "05061"), CODE_011("05062", "IB Theatre", "05062"), CODE_012("05120",
                                                        "Strings", "05120"), CODE_013("05121",
                                                                "Contemporary Vocal Ensemble", "05121"), CODE_014(
                                                                        "05122", "Culturally Influenced Ensemble",
                                                                        "05122"), CODE_015("05123",
                                                                                "Recordingand Production",
                                                                                "05123"), CODE_016("05124",
                                                                                        "Technology/ElectronicMusic",
                                                                                        "05124"), CODE_017("05174",
                                                                                                "APStudioArtTwo-Dimensional",
                                                                                                "05174"), CODE_018(
                                                                                                        "05175",
                                                                                                        "APStudioArtThree-Dimensional",
                                                                                                        "05175"), CODE_019(
                                                                                                                "05176",
                                                                                                                "Calligraphy/Lettering",
                                                                                                                "05176"), CODE_020(
                                                                                                                        "05177",
                                                                                                                        "Animation",
                                                                                                                        "05177"), CODE_021(
                                                                                                                                "05190",
                                                                                                                                "Fashion Design",
                                                                                                                                "05190"), CODE_022(
                                                                                                                                        "05191",
                                                                                                                                        "Industrial Design",
                                                                                                                                        "05191"), CODE_023(
                                                                                                                                                "05192",
                                                                                                                                                "Architectural Design",
                                                                                                                                                "05192"), CODE_024(
                                                                                                                                                        "05193",
                                                                                                                                                        "Interior Design",
                                                                                                                                                        "05193"), CODE_025(
                                                                                                                                                                "05202",
                                                                                                                                                                "IB Arts, Middle Years Program",
                                                                                                                                                                "05202"), CODE_026(
                                                                                                                                                                        "06000",
                                                                                                                                                                        "Foreign Language and Literature",
                                                                                                                                                                        "06000"), CODE_027(
                                                                                                                                                                                "06114",
                                                                                                                                                                                "IB Language B (Spanish), Middle Years Program",
                                                                                                                                                                                "06114"), CODE_028(
                                                                                                                                                                                        "06134",
                                                                                                                                                                                        "IB LanguageB (French), Middle Years",
                                                                                                                                                                                        "06134"), CODE_029(
                                                                                                                                                                                                "06153",
                                                                                                                                                                                                "IB LanguageB (Italian), Middle Years Program",
                                                                                                                                                                                                "06153"), CODE_030(
                                                                                                                                                                                                        "06172",
                                                                                                                                                                                                        "IB LanguageB (Portuguese), Middle Years Program",
                                                                                                                                                                                                        "06172"), CODE_031(
                                                                                                                                                                                                                "06213",
                                                                                                                                                                                                                "IB LanguageB (German), Middle Years Program",
                                                                                                                                                                                                                "06213"), CODE_032(
                                                                                                                                                                                                                        "06332",
                                                                                                                                                                                                                        "IB LanguageB (Greek), Middle Years Program",
                                                                                                                                                                                                                        "06332"), CODE_033(
                                                                                                                                                                                                                                "06412",
                                                                                                                                                                                                                                "AP Chinese Language and Culture",
                                                                                                                                                                                                                                "06412"), CODE_034(
                                                                                                                                                                                                                                        "06413",
                                                                                                                                                                                                                                        "IB LanguageB (Chinese), Middle Years Program",
                                                                                                                                                                                                                                        "06413"), CODE_035(
                                                                                                                                                                                                                                                "06432",
                                                                                                                                                                                                                                                "AP Japanese Language and Culture",
                                                                                                                                                                                                                                                "06432"), CODE_036(
                                                                                                                                                                                                                                                        "06433",
                                                                                                                                                                                                                                                        "IB LanguageB (Japanese), Middle Years Program",
                                                                                                                                                                                                                                                        "06433"), CODE_037(
                                                                                                                                                                                                                                                                "06452",
                                                                                                                                                                                                                                                                "IB LanguageB (Korean), Middle Years Program",
                                                                                                                                                                                                                                                                "06452"), CODE_038(
                                                                                                                                                                                                                                                                        "06512",
                                                                                                                                                                                                                                                                        "IB LanguageB (Vietnamese), Middle Years Program",
                                                                                                                                                                                                                                                                        "06512"), CODE_039(
                                                                                                                                                                                                                                                                                "06532",
                                                                                                                                                                                                                                                                                "IB LanguageB (Filipino), Middle Years Program",
                                                                                                                                                                                                                                                                                "06532"), CODE_040(
                                                                                                                                                                                                                                                                                        "06612",
                                                                                                                                                                                                                                                                                        "IB LanguageB (Russian), Middle Years Program",
                                                                                                                                                                                                                                                                                        "06612"), CODE_041(
                                                                                                                                                                                                                                                                                                "06713",
                                                                                                                                                                                                                                                                                                "IB LanguageB (Hebrew), Middle Years Program",
                                                                                                                                                                                                                                                                                                "06713"), CODE_042(
                                                                                                                                                                                                                                                                                                        "06733",
                                                                                                                                                                                                                                                                                                        "IB LanguageB (Arabic), Middle Years Program",
                                                                                                                                                                                                                                                                                                        "06733"), CODE_043(
                                                                                                                                                                                                                                                                                                                "06772",
                                                                                                                                                                                                                                                                                                                "IB LanguageB (Swahili), Middle Years Program",
                                                                                                                                                                                                                                                                                                                "06772"), CODE_044(
                                                                                                                                                                                                                                                                                                                        "06806",
                                                                                                                                                                                                                                                                                                                        "IB LanguageB (American Sign Language), Middle Years Program",
                                                                                                                                                                                                                                                                                                                        "06806"), CODE_045(
                                                                                                                                                                                                                                                                                                                                "06832",
                                                                                                                                                                                                                                                                                                                                "IB LanguageB (American Indian Language), MiddleY ears Program",
                                                                                                                                                                                                                                                                                                                                "06832"), CODE_046(
                                                                                                                                                                                                                                                                                                                                        "07000",
                                                                                                                                                                                                                                                                                                                                        "Religious Education and Theology",
                                                                                                                                                                                                                                                                                                                                        "07000"), CODE_047(
                                                                                                                                                                                                                                                                                                                                                "08000",
                                                                                                                                                                                                                                                                                                                                                "Physical, Health, and Safety Education",
                                                                                                                                                                                                                                                                                                                                                "08000"), CODE_048(
                                                                                                                                                                                                                                                                                                                                                        "08040",
                                                                                                                                                                                                                                                                                                                                                        "IB Physical Education, Middle Years Program",
                                                                                                                                                                                                                                                                                                                                                        "08040"), CODE_049(
                                                                                                                                                                                                                                                                                                                                                                "09000",
                                                                                                                                                                                                                                                                                                                                                                "Military Science",
                                                                                                                                                                                                                                                                                                                                                                "09000"), CODE_050(
                                                                                                                                                                                                                                                                                                                                                                        "10000",
                                                                                                                                                                                                                                                                                                                                                                        "Computer and Information Sciences",
                                                                                                                                                                                                                                                                                                                                                                        "10000"), CODE_051(
                                                                                                                                                                                                                                                                                                                                                                                "10011",
                                                                                                                                                                                                                                                                                                                                                                                "Computer Science Principles",
                                                                                                                                                                                                                                                                                                                                                                                "10011"), CODE_052(
                                                                                                                                                                                                                                                                                                                                                                                        "10012",
                                                                                                                                                                                                                                                                                                                                                                                        "Exploring Computer Science",
                                                                                                                                                                                                                                                                                                                                                                                        "10012"), CODE_053(
                                                                                                                                                                                                                                                                                                                                                                                                "10112",
                                                                                                                                                                                                                                                                                                                                                                                                "Local Area Networking",
                                                                                                                                                                                                                                                                                                                                                                                                "10112"), CODE_054(
                                                                                                                                                                                                                                                                                                                                                                                                        "10205",
                                                                                                                                                                                                                                                                                                                                                                                                        "Computer Gaming and Design",
                                                                                                                                                                                                                                                                                                                                                                                                        "10205"), CODE_055(
                                                                                                                                                                                                                                                                                                                                                                                                                "10206",
                                                                                                                                                                                                                                                                                                                                                                                                                "Mobile Applications",
                                                                                                                                                                                                                                                                                                                                                                                                                "10206"), CODE_056(
                                                                                                                                                                                                                                                                                                                                                                                                                        "10301",
                                                                                                                                                                                                                                                                                                                                                                                                                        "Computer Forensics",
                                                                                                                                                                                                                                                                                                                                                                                                                        "10301"), CODE_057(
                                                                                                                                                                                                                                                                                                                                                                                                                                "10302",
                                                                                                                                                                                                                                                                                                                                                                                                                                "Cyber Crime",
                                                                                                                                                                                                                                                                                                                                                                                                                                "10302"), CODE_058(
                                                                                                                                                                                                                                                                                                                                                                                                                                        "11000",
                                                                                                                                                                                                                                                                                                                                                                                                                                        "Communication and Audio/Visual Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                        "11000"), CODE_059(
                                                                                                                                                                                                                                                                                                                                                                                                                                                "11004",
                                                                                                                                                                                                                                                                                                                                                                                                                                                "SocialMedia",
                                                                                                                                                                                                                                                                                                                                                                                                                                                "11004"), CODE_060(
                                                                                                                                                                                                                                                                                                                                                                                                                                                        "11106",
                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Emerging Technologies in Journalism",
                                                                                                                                                                                                                                                                                                                                                                                                                                                        "11106"), CODE_061(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                "11107",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Radio Production",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                "11107"), CODE_062(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Business and Marketing",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12000"), CODE_063(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12060",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Business Ethics",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12060"), CODE_064(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12108",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Cost Accounting",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12108"), CODE_065(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12109",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Income Tax Accounting",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12109"), CODE_066(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12110",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Payroll Accounting",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12110"), CODE_067(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12111",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Particular Topics in Accounting",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12111"), CODE_068(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12168",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "MarketingCommodities",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "12168"), CODE_069(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12169",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Social Media Marketing",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "12169"), CODE_070(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "13000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Manufacturing",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "13000"), CODE_071(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "13303",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Industrial Maintenance",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "13303"), CODE_072(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Health Care Sciences",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14000"), CODE_073(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "14003",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Medical Law and Ethics",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "14003"), CODE_074(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14156",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Medical Coding and Transcription",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14156"), CODE_075(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "14157",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Health Informatics and Data Management",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "14157"), CODE_076(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14255",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Biomedical Innovation",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "14255"), CODE_077(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Public, Protective, and Government Services",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15000"), CODE_078(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15054",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Law Enforcement",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15054"), CODE_079(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15055",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Forensic Science",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15055"), CODE_080(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15056",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Crime Scene Management",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15056"), CODE_081(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15057",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Criminal Law and Procedures",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15057"), CODE_082(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15058",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Ethics in Criminal Justice",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "15058"), CODE_083(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15104",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Public Safety Telecommunications",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "15104"), CODE_084(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "16000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Hospitality and Tourism",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "16000"), CODE_085(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "16204",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Recreation, Amusement, and Attractions Management",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "16204"), CODE_086(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Architectureand Construction",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17000"), CODE_087(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17013",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Commercial Construction",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17013"), CODE_088(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17014",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Concrete Foundations",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17014"), CODE_089(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17015",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Construction Estimating",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17015"), CODE_090(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17016",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Construction Management",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "17016"), CODE_091(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17017",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Particular Topics in Construction",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "17017"), CODE_092(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Agriculture, Food, and Natural Resources",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18000"), CODE_093(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18004",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Biological Applications in Agriculture",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18004"), CODE_094(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18005",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Particular Topics in Environmental Service Systems",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18005"), CODE_095(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18107",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Animal Nutrition",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18107"), CODE_096(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18108",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Animal Genetics",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18108"), CODE_097(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18109",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Integrated Pest Management",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18109"), CODE_098(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18205",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Agriculture Computers and Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18205"), CODE_099(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18310",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Sustainable/Alternative Agriculture",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18310"), CODE_100(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18311",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Viticulture",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18311"), CODE_101(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18406",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Water Treatment",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "18406"), CODE_102(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18506",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Alternative Energy",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "18506"), CODE_103(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "19000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Human Services",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "19000"), CODE_104(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "19155",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Instructional Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "19155"), CODE_105(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "19301",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Counseling and Mental Health",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "19301"), CODE_106(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "20000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Transportation, Distribution, and Logistics",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "20000"), CODE_107(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "20055",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Pilot Training",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "20055"), CODE_108(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "20119",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Hybrid Engines",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "20119"), CODE_109(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "20120",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Motorsports Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "20120"), CODE_110(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21000",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Engineering and Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21000"), CODE_111(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21016",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Engineering Analysis",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21016"), CODE_112(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21057",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Laser/Fiber Optics",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21057"), CODE_113(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21058",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Geospatial Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21058"), CODE_114(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21059",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Modeling and Simulation Technology",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21059"), CODE_115(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21060",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Wind Energy",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21060"), CODE_116(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21061",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "WindTurbine Construction and Operation",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "21061"), CODE_117(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21062",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "IB Technology, Middle Years Program",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "21062"), CODE_118(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22110",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "AP Seminar",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22110"), CODE_119(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22251",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Community Living",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22251"), CODE_120(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22252",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Communication Instruction",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22252"), CODE_121(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22253",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Social Development Instruction",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22253"), CODE_122(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22254",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Developmental Support",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "22254"), CODE_123(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22260",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "IB Personal Project, Middle Years Program",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "22260"), CODE_124(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "64001",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Exploration of Health Care Occupations",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "64001"), CODE_125(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "71052",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "IB Technology, Middle Years Program",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "71052"), CODE_126(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "72260",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "IB Personal Project, Middle Years Program",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "72260"), CODE_127(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73028",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Early Childhood Education",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73028"), CODE_128(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73029",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Pre-kindergarten",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73029"), CODE_129(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73036",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Grade6",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73036"), CODE_130(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73037",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "Grade7",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73037"), CODE_131(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73038",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "Grade8",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "73038"), CODE_132(
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73041",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "IB Primary Years Program",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "73041");

        // Constants
        private static final int MAX_DESC_LENGTH = 100;
        private static final int MAX_CODE_LENGTH = 5;
        private static final char PAD_CHAR = '0';

        // Enum members
        private String m_code;
        private String m_description;
        private String m_stateCode;

        /**
         * Gets the code.
         *
         * @return String
         */
        public String getCode() {
            return m_code;
        }

        /**
         * Gets the description.
         *
         * @return String
         */
        public String getDescription() {
            return m_description;
        }

        /**
         * Gets the state code.
         *
         * @return String
         */
        public String getStateCode() {
            return m_stateCode;
        }

        /**
         * Instantiates a new codes to update.
         *
         * @param code String
         * @param description String
         * @param stateCode String
         */
        private CODES_TO_UPDATE(String code, String description, String stateCode) {
            m_code = StringUtils.padLeft(code, MAX_CODE_LENGTH, PAD_CHAR);

            // Truncate to 100 characters if needed
            m_description =
                    description.length() < MAX_DESC_LENGTH ? description : description.substring(0, MAX_DESC_LENGTH);

            m_stateCode = StringUtils.padLeft(stateCode, MAX_CODE_LENGTH, PAD_CHAR);
        }
    }

    // Aliases
    private static final String ALIAS_COURSE_ID = "RI Course ID";

    private ModelBroker m_broker;
    private Set<String> m_refCodes;
    private String m_refTableOid;

    /**
     * Gets the broker.
     *
     * @return X 2 broker
     * @see com.x2dev.sis.tools.ToolJavaSource#getBroker()
     */
    @Override
    protected X2Broker getBroker() {
        if (m_broker == null) {
            m_broker = new ModelBroker(getPrivilegeSet());
        }
        return m_broker;
    }

    /**
     * Initialize.
     *
     * @throws X2BaseException exception
     * @see com.x2dev.sis.tools.ToolJavaSource#initialize()
     */
    @Override
    protected void initialize() throws X2BaseException {
        DataDictionary dictionary = DataDictionary.getDistrictDictionary(getBroker().getPersistenceKey());
        DataDictionaryField dictionaryField = dictionary.findDataDictionaryFieldByAlias(ALIAS_COURSE_ID);

        if (dictionaryField == null) {
            logMessage("Alias = " + ALIAS_COURSE_ID + " can not be found in the Dictionary");
            return;
        } else if (!dictionaryField.getId().toLowerCase().startsWith(Course.OBJECT_PREFIX.toLowerCase())) {
            logMessage("Alias = " + ALIAS_COURSE_ID + " is not set for the Course table.");
            return;
        } else if (StringUtils.isEmpty(m_refTableOid = dictionaryField.getReferenceTableOid())) {
            logMessage("Reference table is not set for the Field with Alias = " + ALIAS_COURSE_ID + ".");
            return;
        } else {
            loadCurrentRefCodes();
        }

    }

    /**
     * Execute.
     *
     * @throws Exception exception
     * @see com.follett.fsc.core.k12.tools.procedures.ProcedureJavaSource.execute() throws Exception
     */
    @Override
    protected void execute() throws Exception {
        if (m_refCodes != null) {
            for (CODES_TO_UPDATE item : CODES_TO_UPDATE.values()) {
                String code = item.getCode();
                if (!m_refCodes.contains(code)) {
                    String stateCode = item.getStateCode();
                    String description = item.getDescription();

                    if (!StringUtils.isEmpty(stateCode)) {
                        ReferenceCode newRcd = X2BaseBean.newInstance(ReferenceCode.class,
                                m_broker.getPersistenceKey());
                        newRcd.setReferenceTableOid(m_refTableOid);
                        newRcd.setStateCode(stateCode);
                        newRcd.setCode(code);
                        newRcd.setDescription(description);
                        newRcd.setSequenceNumber(0);
                        newRcd.setNoHideIndicator(false);
                        newRcd.setDisabledIndicator(false);

                        if (newRcd.isDirty()) {
                            m_broker.saveBeanForced(newRcd);

                            logMessage("Reference code was created: Code = " + code + ", StateCode = " + stateCode
                                    + ", ReferenceTableOid = " + m_refTableOid + ", Reference Table = SCED Codes.");

                        }
                    }
                } else {
                    logMessage("Reference code already exists in DB. Code = " + code + ".");
                }
            }
        }
    }

    /**
     * Loads a map of students keyed on Student Pin numbers.
     */
    private void loadCurrentRefCodes() {
        X2Criteria criteria = new X2Criteria();
        criteria.addEqualTo(ReferenceCode.COL_REFERENCE_TABLE_OID, m_refTableOid);
        QueryByCriteria query = new QueryByCriteria(ReferenceCode.class, criteria);

        m_refCodes = m_broker.getGroupedCollectionByQuery(query, ReferenceCode.COL_CODE, 1024).keySet();
    }

}
